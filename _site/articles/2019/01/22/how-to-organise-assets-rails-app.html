<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>How to neatly organise assets in a Rails app | Alberto Fernández-Capel</title>



<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">


<script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" integrity="sha256-iM4Yzi/zLj/IshPWMC1IluRxTtRjMqjPGd97TZ9yYpU=" crossorigin="anonymous"></script>

<link rel="alternate" type="application/rss+xml" href="/feed.xml" />

</head>



<body class="layout-post">


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Site brand
    ================================================== -->
    <a class="navbar-brand" href="/">
      Alberto Fernández-Capel
      <small class="text-muted d-none d-md-inline">Personal Blog</small>
    </a>
    <!-- End brand -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>


    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item">
                
                <a class="nav-link" href="/index.html">Blog</a>
                </li>

                
                <li class="nav-item">
                
                <a class="nav-link" href="/about">About</a>
                </li>

                <li class="nav-item">
                <a target="_blank"  class="nav-link" href="https://twitter.com/afcapel"><i class="fab fa-twitter"></i></a>
                </li>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">
<div class="container">



<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Post Share -->
		<div class="col-md-2 pl-0">
           <div class="share">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=How to neatly organise assets in a Rails app&url=http://localhost:4000/articles/2019/01/22/how-to-organise-assets-rails-app.html" rel="noopener noreferrer">
        <i class="fab fa-twitter"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://news.ycombinator.com/submitlink?u=http://localhost:4000/articles/2019/01/22/how-to-organise-assets-rails-app.html&t=How to neatly organise assets in a Rails app" rel="noopener noreferrer">
        <i class="fab fa-hacker-news"></i>
        </a>
        </li>
    </ul>
</div>

		</div>


		<!-- Post -->
        

		<div class="col-md-9 flex-first flex-md-unordered">
			<div class="mainheading">

                <!-- Author Box -->
                
				<div class="row post-top-meta">
					<div class="col-md-2 col-4">
						<img class="author-thumb" src="https://www.gravatar.com/avatar/ec109e50efa17647903b7f31eee1c458?s=250&d=mm&r=x" alt="Alberto">
					</div>
					<div class="col-md-10 col-8">
						<a target="_blank" class="link-dark" href="https://afcapel.com">Alberto</a><a target="_blank" href="https://twitter.com/afcapel" class="btn follow">Follow</a>
						<span class="author-description">I build software</span>
					</div>
				</div>
                

                <!-- Post Title -->
				<h1 class="posttitle">How to neatly organise assets in a Rails app</h1>

			</div>

			<!-- Post Featured Image -->
			<img class="featured-image w-100 img-fluid" src="http://localhost:4000/assets/images/shelf.jpg" alt="How to neatly organise assets in a Rails app">
			<!-- End Featured Image -->

			<!-- Post Content -->
			<div class="article-post">
				<p>One of the great things about Rails is that it comes packed with a lot of useful
conventions. I can open open a new Rails application and I immediately know where the
controllers are and how they are mapped to their views. On the other hand, Rails
doesn’t provide much of a guideline about how you should organise your assets. This
is probably a cultural issue: rails developers are usually more proficient
with backend programming than with css or javascript. But there’s also a natural
relationship between assets and views. We can leverage this relationship to map assets
to views, in the same way that views are mapped to controllers.</p>

<p>First things first, let’s clarify what we want to achieve: <strong>we want to make dead easy to understand which assets assets are used in any part of the app</strong>. The mapping should also work the other way around: given a css or js file, it should be obvious where in the app is used.
How can we achieve that?</p>

<p>Let’s say we have a typical rails controller dir:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/controllers
├── admin
│   ├── base_controller.rb
│   ├── dashboard_controller.rb
│   ├── ... other admin controllers
├── api
│   ├── base_controller.rb
│   └── ... other api controllers
├── application_controller.rb
├── authenticated
│   ├── onboarding
│   │   ├── base_controller.rb
│   │   └── ... other onboarding controllers
│   ├── settings
│   │   ├── accounts_controller.rb
│   │   └── ... other settings controllers
│   ├── base_controller.rb
│   ├── .. other authenticated controllers
└── public
    ├── base_controller.rb
    └──  ... other public controllers
</code></pre></div></div>

<p>This is all standard rails with some fairly typical namespacing. At the top level we have
a few namespaces for the main areas of the app: <code class="highlighter-rouge">admin</code>, <code class="highlighter-rouge">api</code>, <code class="highlighter-rouge">authenticated</code>,
and <code class="highlighter-rouge">public</code>. <strong>Each one of these main areas have its own base controller and a
specific layout</strong>. The <code class="highlighter-rouge">authenticated</code> namespace is for pages that can only be seen
by authenticated users and it’s the bulk of the app. Because it’s so big, it has a few subnamespaces for it’s thematic subareas: <code class="highlighter-rouge">settings</code> for all the settings controllers, <code class="highlighter-rouge">onboarding</code> for all the controllers dealing with user onboarding.</p>

<p>Following rails conventions, the views associated with these controller have the
same directory structure:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/views
├── admin
│   ├── dashboard
│   │   └── show.html.erb
│   ├── ... other admin views
├── api
│   └── ... api jbuilder views
├── authenticated
│   ├── ... authenticated views
│   ├── onboarding
│   │   ├── ... onboarding views
│   ├── settings
│   │   ├── ... settings views
├── layouts
│   ├── admin.html.erb
│   ├── application.html.erb
│   ├── mailer.html.erb
│   └── public.html.erb
├── public
│   └── ... public views
└── shared &lt;- These are partials shared by different controllers
   ├── _error_messages.html.erb
   ├── _flash.html.erb
   └── .. other shared partials
</code></pre></div></div>

<p>So we have views mapped by convention to controllers, and that makes it very easy
to know which view is used for each controller and what controllers is associated with a view.
<strong>The next natural step is to use the same mapping from vies to stylesheets</strong>. My stylesheet
dir looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/assets/stylesheets
├── admin
│   ├── _dashboard.scss &lt;- styles used by all admin/dashboard actions
│   │   └── _show.scss  &lt;- styles used by the admin/dashboard#show action
│   └── shared &lt;- These are partials that are shared by all admin views
│       ├── _layout.scss &lt;- styles for the admin layout
│       ├── _navbar.scss &lt;- Other partials used in
│       └── _sidebar.scss
├── admin.scss
├── authenticated
│   ├── _layout.scss
│   ├── _onboarging.scss  &lt;- These are partials that are shared by all onboarding views
│   ├── settings &lt;- These are partials that are shared by all settings views
│   │   └── subscriptions
│   │       └── _show.scss &lt;- Styles only used in settings/subscriptions/show
│   └── shared &lt;- Common components. These are partials that are shared by all views
│       ├── _card.scss
│       ├── ... other components
│       ├── _spinner.scss
│       └── _thumbs.scss
├── authenticated.scss &lt;- main css for the authenticated layout
├── public
│   ├── _layout.scss
│   └── shared  &lt;- These are partials that are shared by public views
│       └── ... components only used in the public layout
├── public.scss &lt;- main css for the public layout
└── shared &lt;- css shared by all layouts
    ├── _functions.scss
    ├── _mixins.scss
    ├── _variables.scss
    ├── pills.scss
    └── ... other global components
</code></pre></div></div>

<p>The directory structure follows the same layout than views and controllers. <strong>The main
rule is to always nest the file name to the most specific folder possible</strong>. For instance:</p>

<ul>
  <li>
    <p>If some styles are only needed in <code class="highlighter-rouge">app/views/admin/dashboard/show.html.erb</code> they will
go in <code class="highlighter-rouge">app/assets/stylesheets/admin/dashboard/_show.scss</code>.</p>
  </li>
  <li>
    <p>If they are shared between actions in the <code class="highlighter-rouge">admin/dashboard_controller</code>, they would go
in <code class="highlighter-rouge">app/assets/stylesheets/admin/dashboard.scss</code></p>
  </li>
  <li>
    <p>If they are shared by different admin controllers, they go in
<code class="highlighter-rouge">app/assets/stylesheets/admin/shared/name_of_the_component.scss</code></p>
  </li>
  <li>
    <p>If they are shared by controllers with different layouts, they go in
<code class="highlighter-rouge">app/assets/stylesheets/shared/name_of_the_component.scss</code></p>
  </li>
</ul>

<p>The top level stylesheets just include the folders they need. For instance,
<code class="highlighter-rouge">app/assets/stylesheets/admin.scss</code> is just:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@import</span> <span class="s1">"shared/**/*"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s1">"admin/**/*"</span><span class="p">;</span>
</code></pre></div></div>

<p>These days I mostly use <a href="https://stimulusjs.org/">stimulus</a> for the front end. Stimulus
already comes with sensible file naming convention. But if you still have a lot of
js sprinkles in your app, you can use the same convention to organise <code class="highlighter-rouge">app/assets/javascripts</code>.
In this way you only need one criteria to organise most of the code in your application:
from controllers, to views, including css and javascript.</p>

			</div>

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2019-01-22">22 Jan 2019</time></span>
                
                </small>
            </p>

			<!-- Post Categories -->
			<div class="after-post-tags">
				<ul class="tags">
                    
                    
                    <li>
                     <a href="/category/articles/">articles</a>
                    </li>
                    
				</ul>
			</div>
			<!-- End Categories -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="http://localhost:4000/articles/2019/01/18/cognitive-load-in-programming.html"> &laquo; Cognitive load in programming: why the brain is the bottleneck</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="http://localhost:4000/articles/2019/02/08/why-async-io-is-not-worth-the-trouble.html">Why async programming is not worth the trouble &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

</div>

</div><!-- /.container>


<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container text-center">
      <p class="text-center">
        Copyright © 2020 Alberto Fernández-Capel
      </p>
    </div>
</footer>
<!-- End Footer
================================================== -->


</div> <!-- /.site-content>
</body>
</html>
